<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Reminder_email</name>
        <label>Reminder email</label>
        <locationX>176</locationX>
        <locationY>252</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>frmRecipients</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>DefaultWorkflowUser</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <stringValue>*Salesforce notification* Submit the signed contract for your Awarded opportunity</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>tplEmailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>sendRichBody</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ccRecipientAddressList</name>
            <value>
                <stringValue>Salesforce.SC@soprasteria.com</stringValue>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>61.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <description>Sends weekly reminder for missing contract in stage 5</description>
    <environments>Default</environments>
    <formulas>
        <name>frmRecipients</name>
        <dataType>String</dataType>
        <expression>{!$Record.Owner.Email} &amp; IF({!$Record.BID_Office_Owner__r.Email}!=&quot;&quot;,&quot;,&quot;,&quot;&quot;)&amp; {!$Record.BID_Office_Owner__r.Email}</expression>
    </formulas>
    <interviewLabel>Scheduled: Opportunity - Email reminders for missing contract {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Scheduled: Opportunity - Email reminders for missing contract</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Reminder_email</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>5 - Awarded</stringValue>
            </value>
        </filters>
        <filters>
            <field>IsContractUploaded__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Awarded_since__c</field>
            <operator>GreaterThan</operator>
            <value>
                <numberValue>6.0</numberValue>
            </value>
        </filters>
        <filters>
            <field>DashboardsGSP__Last_Stage_Change_Date__c</field>
            <operator>GreaterThan</operator>
            <value>
                <dateValue>2025-01-01</dateValue>
            </value>
        </filters>
        <filters>
            <field>Weekday_for_Contract_Missing_Alert__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Alert_Missing_Contract_LastDate__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>New_or_Renewal__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Renewal</stringValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <schedule>
            <frequency>Daily</frequency>
            <startDate>2025-03-20</startDate>
            <startTime>08:30:00.000Z</startTime>
        </schedule>
        <triggerType>Scheduled</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <description>Body for reminder email</description>
        <name>tplEmailBody</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;You are receiving this reminder because your are the opportunity owner of an Awarded opportunity with no contract in Salesforce.&lt;/p&gt;&lt;p&gt;Please upload the signed contract and all attachments in Salesforce as soon as it is available.&lt;/p&gt;&lt;p&gt;Once you have uploaded the contract, Finance will approve the contract, and the opportunity will automatically be set to Closed Won. If there are any questions related to the contract, Finance will be in touch with you!&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;Link to Opportunity: &lt;/strong&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(68, 68, 68);&quot;&gt;{!$Label.BaseURL}{!$Record.Id}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Account name:&lt;/strong&gt; {!$Record.Account_Name__c}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Opportunity name:&lt;/strong&gt; {!$Record.Name}&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;If there are problems with your contract, please click the &quot;Report Contract Problem&quot; button in the Opportunity page and describe the details. &lt;/p&gt;&lt;p&gt;You may also contact the contract management team if you have questions.&lt;/p&gt;&lt;p&gt;Norway and Denmark: &lt;a href=&quot;mailto:contracts@soprasteria.com&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;contracts@soprasteria.com&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Sweden: &lt;a href=&quot;mailto:contracts.SE@soprasteria.com&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;contracts.SE@soprasteria.com&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;color: rgb(253, 4, 4);&quot;&gt;You cannot respond to this email&lt;/strong&gt;. If you have received this email in error, please contact your Salesforce administrator&lt;/p&gt;</text>
    </textTemplates>
</Flow>
